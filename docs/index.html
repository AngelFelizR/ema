<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Predictive Models: Visualisation, Exploration and Explanation</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Predictive Models: Visualisation, Exploration and Explanation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Predictive Models: Visualisation, Exploration and Explanation" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Przemyslaw Biecek and Tomasz Burzykowski">


<meta name="date" content="2018-09-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  

<link rel="next" href="prediction-level-explanations.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Predictive Models:<br/> Visualisation, Exploration and Explanation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#model-lifecycle"><i class="fa fa-check"></i><b>1.1</b> Model Lifecycle</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-do-we-need-model-explainers"><i class="fa fa-check"></i><b>1.2</b> Why do we need model explainers?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#black-box-models-vs-white-box-models"><i class="fa fa-check"></i><b>1.3</b> Black-box models vs White-box models</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#model-agnostic-vs-model-specific"><i class="fa fa-check"></i><b>1.4</b> Model agnostic vs Model specific</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#glossary-notation"><i class="fa fa-check"></i><b>1.5</b> Glossary / Notation</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#thanksto"><i class="fa fa-check"></i><b>1.6</b> Thanks to</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="prediction-level-explanations.html"><a href="prediction-level-explanations.html"><i class="fa fa-check"></i>Prediction level explanations</a></li>
<li class="chapter" data-level="2" data-path="PredictionExplainers.html"><a href="PredictionExplainers.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="PredictionExplainers.html"><a href="PredictionExplainers.html#variable-atribution-vs-what-if-analysis"><i class="fa fa-check"></i><b>2.1</b> Variable atribution vs What-if analysis</a></li>
<li class="chapter" data-level="2.2" data-path="PredictionExplainers.html"><a href="PredictionExplainers.html#when-to-use"><i class="fa fa-check"></i><b>2.2</b> When to use?</a></li>
<li class="chapter" data-level="2.3" data-path="PredictionExplainers.html"><a href="PredictionExplainers.html#three-single-laws"><i class="fa fa-check"></i><b>2.3</b> A bit of philosophy: Three Laws for Prediction Level Explanations</a></li>
<li class="chapter" data-level="2.4" data-path="PredictionExplainers.html"><a href="PredictionExplainers.html#example-promoted-or-fired"><i class="fa fa-check"></i><b>2.4</b> Example: Promoted or Fired?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="break-down.html"><a href="break-down.html"><i class="fa fa-check"></i><b>3</b> Break Down</a><ul>
<li class="chapter" data-level="3.1" data-path="break-down.html"><a href="break-down.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="break-down.html"><a href="break-down.html#how-to-read-break-down-plots"><i class="fa fa-check"></i><b>3.2</b> How to read Break Down Plots?</a></li>
<li class="chapter" data-level="3.3" data-path="break-down.html"><a href="break-down.html#how-to-construct-break-down-plots"><i class="fa fa-check"></i><b>3.3</b> How to construct Break Down Plots</a></li>
<li class="chapter" data-level="3.4" data-path="break-down.html"><a href="break-down.html#interactions"><i class="fa fa-check"></i><b>3.4</b> Interactions</a></li>
<li class="chapter" data-level="3.5" data-path="break-down.html"><a href="break-down.html#pros-and-cons"><i class="fa fa-check"></i><b>3.5</b> Pros and cons</a></li>
<li class="chapter" data-level="3.6" data-path="break-down.html"><a href="break-down.html#code-snippets-for-r"><i class="fa fa-check"></i><b>3.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="shapley.html"><a href="shapley.html"><i class="fa fa-check"></i><b>4</b> Shapley Values</a></li>
<li class="chapter" data-level="5" data-path="LIME.html"><a href="LIME.html"><i class="fa fa-check"></i><b>5</b> LIME: Local Interpretable Model-Agnostic Explanations</a></li>
<li class="chapter" data-level="6" data-path="ceterisParibus.html"><a href="ceterisParibus.html"><i class="fa fa-check"></i><b>6</b> Ceteris Paribus Principle</a><ul>
<li class="chapter" data-level="6.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#ceterisParibus1d"><i class="fa fa-check"></i><b>6.2</b> 1D profiles</a></li>
<li class="chapter" data-level="6.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#oscillations"><i class="fa fa-check"></i><b>6.3</b> Profile oscillations</a></li>
<li class="chapter" data-level="6.4" data-path="ceterisParibus.html"><a href="ceterisParibus.html#d-profiles"><i class="fa fa-check"></i><b>6.4</b> 2D profiles</a></li>
<li class="chapter" data-level="6.5" data-path="ceterisParibus.html"><a href="ceterisParibus.html#local-model-fidelity"><i class="fa fa-check"></i><b>6.5</b> Local model fidelity</a></li>
<li class="chapter" data-level="6.6" data-path="ceterisParibus.html"><a href="ceterisParibus.html#pros-and-cons-1"><i class="fa fa-check"></i><b>6.6</b> Pros and cons</a></li>
<li class="chapter" data-level="6.7" data-path="ceterisParibus.html"><a href="ceterisParibus.html#code-snippets-for-r-1"><i class="fa fa-check"></i><b>6.7</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-level-explanations.html"><a href="model-level-explanations.html"><i class="fa fa-check"></i>Model level explanations</a></li>
<li class="chapter" data-level="7" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>7</b> Introduction</a><ul>
<li class="chapter" data-level="7.1" data-path="introduction-3.html"><a href="introduction-3.html#example-price-prediction"><i class="fa fa-check"></i><b>7.1</b> Example: Price prediction</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="variable-importance.html"><a href="variable-importance.html"><i class="fa fa-check"></i><b>8</b> Variable Importance</a></li>
<li class="chapter" data-level="9" data-path="marginal-response.html"><a href="marginal-response.html"><i class="fa fa-check"></i><b>9</b> Marginal Response</a><ul>
<li class="chapter" data-level="9.1" data-path="marginal-response.html"><a href="marginal-response.html#partial-dependency-plots"><i class="fa fa-check"></i><b>9.1</b> Partial Dependency Plots</a></li>
<li class="chapter" data-level="9.2" data-path="marginal-response.html"><a href="marginal-response.html#merging-path-plots"><i class="fa fa-check"></i><b>9.2</b> Merging Path Plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="performance-diagnostic.html"><a href="performance-diagnostic.html"><i class="fa fa-check"></i><b>10</b> Performance Diagnostic</a></li>
<li class="chapter" data-level="11" data-path="residual-diagnostic.html"><a href="residual-diagnostic.html"><i class="fa fa-check"></i><b>11</b> Residual Diagnostic</a></li>
<li class="chapter" data-level="12" data-path="other-topics.html"><a href="other-topics.html"><i class="fa fa-check"></i><b>12</b> Other topics</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/pbiecek/DALEX" target="blank">DALEX website</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Models: Visualisation, Exploration and Explanation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Predictive Models: Visualisation, Exploration and Explanation</h1>
<h4 class="author"><em>Przemyslaw Biecek and Tomasz Burzykowski</em></h4>
<h4 class="date"><em>2018-09-14</em></h4>
</div>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<p>Machine Learning (ML) models have a wide range of applications in classification or regression problems. Due to the increasing computational power of computers and complexity of data sources, ML models are becoming more and more sophisticated. Models created with the use of techniques such as boosting or bagging of neural networks are parametrized by thousands of coefficients. They are obscure; it is hard to trace the link between input variables and model outcomes - in fact they are treated as black boxes. They are used because of their elasticity and high performance, but their deficiency in interpretability is one of their weakest sides.</p>
<p>In many applications we need to know, understand or prove how the input variables are used in the model. We need to know the impact of particular variables on the final model predictions. Thus we need tools that extract useful information from thousands of model parameters.</p>
<p>Fully trained models</p>
<div id="model-lifecycle" class="section level2">
<h2><span class="header-section-number">1.1</span> Model Lifecycle</h2>
<div class="figure">
<img src="figure/mp_understanding.png" alt="Workflow of a typical machine learning modeling. A) Modeling is a process in which domain knowledge and data are turned into models. B) Models are used to generate predictions. C) Understanding of a model structure may increase our knowledge, and in consequence it may lead to a better model. DALEX helps here. D) Understanding of drivers behind a particular model’s predictions may help to correct wrong decisions, and in consequence it leads to a better model. DALEX helps here." />
<p class="caption">Workflow of a typical machine learning modeling.
A) Modeling is a process in which domain knowledge and data are turned into models.
B) Models are used to generate predictions.
C) Understanding of a model structure may increase our knowledge, and in consequence it may lead to a better model. DALEX helps here.
D) Understanding of drivers behind a particular model’s predictions may help to correct wrong decisions, and in consequence it leads to a better model. DALEX helps here.</p>
</div>
<p>Variable importance</p>
<p>Model response as a function of a variable</p>
<p>Model performance / diagnostic / validation</p>
</div>
<div id="why-do-we-need-model-explainers" class="section level2">
<h2><span class="header-section-number">1.2</span> Why do we need model explainers?</h2>
<p>AutoML</p>
<p>Feature Extraction</p>
<p>Model Improvement</p>
</div>
<div id="black-box-models-vs-white-box-models" class="section level2">
<h2><span class="header-section-number">1.3</span> Black-box models vs White-box models</h2>
<p><span class="citation">(P. Biecek <a href="#ref-R-DALEX">2018</a><a href="#ref-R-DALEX">c</a>)</span></p>
</div>
<div id="model-agnostic-vs-model-specific" class="section level2">
<h2><span class="header-section-number">1.4</span> Model agnostic vs Model specific</h2>
</div>
<div id="glossary-notation" class="section level2">
<h2><span class="header-section-number">1.5</span> Glossary / Notation</h2>
<p>feature / variable</p>
<p>Let <span class="math inline">\(f_{M}(x): \mathcal R^{d} \rightarrow \mathcal R\)</span> denote a predictive model, i.e. function that takes <span class="math inline">\(d\)</span> dimensional vector and calculate numerical score. In section in which we work with larger number of models we use subscript <span class="math inline">\(M\)</span> to index models. But to simplify notation, this subscript is omitted if profiles for only one model are considered.</p>
<p>Symbol <span class="math inline">\(x \in \mathcal R^d\)</span> refers to a point in the feature space. We use subscript <span class="math inline">\(x_i\)</span> to refer to a different data points and superscript <span class="math inline">\(x^j\)</span> to refer to specific dimensions. Additionally, let <span class="math inline">\(x^{-j}\)</span> denote all coordinates except <span class="math inline">\(j\)</span>-th and let <span class="math inline">\(x|^j=z\)</span> denote a data point <span class="math inline">\(x^*\)</span> with all coordinates equal to <span class="math inline">\(x\)</span> except coordinate <span class="math inline">\(j\)</span> equal to value <span class="math inline">\(z\)</span>. I.e. <span class="math inline">\(\forall_{i \neq {j}} x^i = x^{*,i}\)</span> and <span class="math inline">\(x^j = z\)</span>. In other words <span class="math inline">\(x|^j=z\)</span> denote a <span class="math inline">\(x\)</span> with <span class="math inline">\(j\)</span>th coordinate changed to <span class="math inline">\(z\)</span>.</p>
<p>Now we can define Ceteris Paribus Profile for model <span class="math inline">\(f\)</span>, variable <span class="math inline">\(j\)</span> and point <span class="math inline">\(x\)</span> as</p>
<p><span class="math display">\[
CP^{f, j, x}(z) := f(x|^j = z).
\]</span>
I.e. CP profile is a model response obtained for observations created based on <span class="math inline">\(x\)</span> with <span class="math inline">\(j\)</span> coordinated changes and all other coordinates kept unchanged.</p>
<p>It is convenient to use an alternative name for this plot: What-If Plots. CP profiles show what would happen if only a single variable is changed.</p>
<p>Figure 5.1 shows an example of Ceteris Paribus profile. The black dot stands for prediction for a single observation. Grey line show how the model response would change if in this single observation coordinate <code>surface</code> will be changes to selected value. From this profile one may read that the model response is non monotonic. If <code>construction.year</code> for this observation would be below 1935 the model response would be higher, but if construction year were between 1935 and 1995 the model response would be lower.</p>
</div>
<div id="thanksto" class="section level2">
<h2><span class="header-section-number">1.6</span> Thanks to</h2>
<p>We are using the <strong>bookdown</strong> package <span class="citation">(Xie <a href="#ref-R-bookdown">2018</a>)</span> in this sample book</p>
<p>Chris Drake and Janusz Holyst</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-DALEX">
<p>Biecek, Przemyslaw. 2018c. <em>DALEX: Descriptive mAchine Learning Explanations</em>. <a href="https://pbiecek.github.io/DALEX/" class="uri">https://pbiecek.github.io/DALEX/</a>.</p>
</div>
<div id="ref-R-bookdown">
<p>Xie, Yihui. 2018. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown" class="uri">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="prediction-level-explanations.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["PM_VEE.pdf", "PM_VEE.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
